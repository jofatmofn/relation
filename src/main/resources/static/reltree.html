<html>
	<head>
		<script src="sigmajs/sigma.min.js"></script>
		<!-- script src="sigmajs/plugins/sigma.layout.forceAtlas2.min.js"></script -->
		<script src="sigmajs/plugins/sigma.renderers.edgeLabels.min.js"></script>

		<script src="sigmajs/plugins/sigma.plugins.dragNodes.min.js"></script>

		<script src="sigmajs/plugins/sigma.layout.noverlap.min.js"></script>
		<script src="sigmajs/plugins/sigma.plugins.animate.min.js"></script>

		<script src="js/relationUtils.js"></script>
		<script>
		// TODO: Externalise the script to js/reltree.js
		(async function() {

			var categoryWiseDomainValueVOListMap;
			
			categoryWiseDomainValueVOListMap = await invokeService("/basic/retrieveDomainValues", "");
			g = await invokeService("/basic/retrieveRelations", "");

			// Instantiate sigma:
			s = new sigma({
				graph: g,
				renderer: {
					container: "graph-container",
					type: "canvas"
				}
			});
			/*
			*/

			// https://github.com/jacomyal/sigma.js/issues/939
			// s.startForceAtlas2({worker: true, barnesHutOptimize: false});
			var config = {
				nodeMargin: 3.0,
				scaleNodes: 1.3
			};
			var listener = s.configNoverlap(config);
			// Bind all events:
			listener.bind('start stop interpolate', function(event) {
				console.log(event.type);
			});

			// Start the algorithm:
			s.startNoverlap();
			
			// Initialize the dragNodes plugin:
			var dragListener = sigma.plugins.dragNodes(s, s.renderers[0]);

			dragListener.bind('startdrag', function(event) {
			  console.log(event);
			});
			dragListener.bind('drag', function(event) {
			  console.log(event);
			});
			dragListener.bind('drop', function(event) {
			  console.log(event);
			});
			dragListener.bind('dragend', function(event) {
			  console.log(event);
			});

		})();
		</script>
	</head>
	<body>
		<div id="container">
		  <style>
			#graph-container {
			  top: 0;
			  bottom: 0;
			  left: 0;
			  right: 0;
			  position: absolute;
			}
			#sidebar {
			  bottom: 0;
			  right: 0;
			  width: 20%;
			  height: 100%;
			  position: absolute;
			  background-color: Beige;
			  padding: 10px;
			}
		  </style>
		  <div id="graph-container"></div>
		  <div id="sidebar"/>
		</div>
	</body>
</html>